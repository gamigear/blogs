@page "/tables/quickgridtables"
@using Microsoft.AspNetCore.Components.QuickGrid
@using System.Globalization
@using System.Linq

<div class="page-header-breadcrumb mb-3">
    <div class="d-flex align-center justify-content-between flex-wrap">
        <h1 class="page-title fw-medium fs-18 mb-0">QuickGrid Tables</h1>
        <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="javascript:void(0);">Tables</a></li>
            <li class="breadcrumb-item active" aria-current="page">QuickGrid Tables</li>
        </ol>
    </div>
</div>

<!-- Table 1: People -->
<div class="card custom-card mb-4">
    <div class="card-header">
        <div class="card-title">People Table (Basic Features)</div>
    </div>
    <div class="card-body">
        <div style="overflow-x:auto;">
            <QuickGrid TItem="Person" Items="@people.AsQueryable()" class="border-bottom">
                <PropertyColumn Property="@(p => p.Name)" Title="Name" Sortable="true" />
                <PropertyColumn Property="@(p => p.Age)" Title="Age" Sortable="true" />
                <PropertyColumn Property="@(p => p.City)" Title="City" Sortable="true" />
                <TemplateColumn Title="Actions">
                    <ChildContent Context="p">
                        <button class="btn btn-sm btn-outline-danger" @onclick="@(() => DeletePerson(p))">Delete</button>
                    </ChildContent>
                </TemplateColumn>
            </QuickGrid>
            @if (people.Count == 0)
            {
                <div class="text-center text-muted p-3 custom-data">No Data available.</div>
            }
        </div>
    </div>
</div>

<!-- Table 2: Products with Pagination -->
<div class="card custom-card">
    <div class="card-header">
        <div class="card-title">Product Table (With Pagination)</div>
    </div>
    <div class="card-body product-table custom">
        <div style="overflow-x:auto;">
            <QuickGrid TItem="Product" Items="@products.AsQueryable()" Pagination="productPagination">
                <PropertyColumn Property="@(p => p.ProductName)" Title="Product" Sortable="true" />
                <PropertyColumn Property="@(p => p.Category)" Title="Category" Sortable="true" />
                <TemplateColumn Title="Price">
                    <ChildContent Context="p">
                        <span>@string.Format(CultureInfo.InvariantCulture, "${0:F2}", p.Price)</span>
                    </ChildContent>
                </TemplateColumn>
                <TemplateColumn Title="Stock Status">
                    <ChildContent Context="p">
                        <span class="badge bg-@((p.InStock ? "success" : "danger"))-transparent">
                            @(p.InStock ? "In Stock" : "Out of Stock")
                        </span>
                    </ChildContent>
                </TemplateColumn>
                <TemplateColumn Title="Actions">
                    <ChildContent Context="p">
                        <button class="btn btn-sm btn-outline-danger" @onclick="@(() => DeleteProduct(p))">
                            Delete
                        </button>
                    </ChildContent>
                </TemplateColumn>
            </QuickGrid>
            @if (products.Count == 0)
            {
                <div class="text-center text-muted custom-data p-3">No Data available.</div>
            }
        </div>
        <Paginator State="productPagination" />
    </div>
</div>


@code {
    // Table 1 Data
    public class Person
    {
        public string? Name { get; set; }
        public int Age { get; set; }
        public string? City { get; set; }
    }

    private List<Person> people = new()
    {
        new Person { Name = "Alice", Age = 30, City = "New York" },
        new Person { Name = "Bob", Age = 25, City = "Chicago" },
        new Person { Name = "Charlie", Age = 35, City = "Los Angeles" },
        new Person { Name = "Diana", Age = 28, City = "Houston" }
    };

    private void DeletePerson(Person p)
    {
        people.Remove(p);
        StateHasChanged();
    }

    // Table 2 Data
    PaginationState productPagination = new() { ItemsPerPage = 10 };
    public class Product
    {
        public string? ProductName { get; set; }
        public string? Category { get; set; }
        public decimal Price { get; set; }
        public bool InStock { get; set; }
    }

    private List<Product> products = new()
    {
        new Product { ProductName = "Laptop", Category = "Electronics", Price = 1299.99m, InStock = true },
        new Product { ProductName = "Office Chair", Category = "Furniture", Price = 199.99m, InStock = false },
        new Product { ProductName = "Wireless Mouse", Category = "Accessories", Price = 29.99m, InStock = true },
        new Product { ProductName = "Monitor", Category = "Electronics", Price = 229.99m, InStock = true },
        new Product { ProductName = "Coffee Maker", Category = "Appliances", Price = 89.99m, InStock = false },
        new Product { ProductName = "Laptop", Category = "Electronics", Price = 1299.99m, InStock = true },
        new Product { ProductName = "Office Chair", Category = "Furniture", Price = 199.99m, InStock = false },
        new Product { ProductName = "Wireless Mouse", Category = "Accessories", Price = 29.99m, InStock = true },
        new Product { ProductName = "Monitor", Category = "Electronics", Price = 229.99m, InStock = true },
        new Product { ProductName = "Coffee Maker", Category = "Appliances", Price = 89.99m, InStock = false },
        new Product { ProductName = "Laptop", Category = "Electronics", Price = 1299.99m, InStock = true },
        new Product { ProductName = "Office Chair", Category = "Furniture", Price = 199.99m, InStock = false },
        new Product { ProductName = "Wireless Mouse", Category = "Accessories", Price = 29.99m, InStock = true },
        new Product { ProductName = "Monitor", Category = "Electronics", Price = 229.99m, InStock = true },
        new Product { ProductName = "Coffee Maker", Category = "Appliances", Price = 89.99m, InStock = false },
    };

    private void DeleteProduct(Product p)
    {
        products.Remove(p);
        productPagination.ItemsPerPage = Math.Max(1, Math.Min(10, products.Count));
        StateHasChanged();
    }
}
