
<app-breadcrumb title="Applications" sub_title="Email" active_item="Mail App"></app-breadcrumb>

<div class="main-mail-container mb-3 gap-2 d-flex">
  <div #mailNavigation class="mail-navigation border">
    <div class="d-grid align-items-top p-3 pb-0">
      <button class="btn btn-primary d-flex align-items-center justify-content-center" (click)="open(content)"
        data-bs-toggle="modal" data-bs-target="#mail-Compose">
        <i class="ri-add-circle-line fs-16 align-middle me-1"></i>New Mail
      </button>
    </div>
    <div>
      <overlay-scrollbars>
        <ul (click)="onMailTypeClick()" class="list-unstyled mail-main-nav" id="mail-main-nav">
          <li class="px-0 pt-0">
            <span class="fs-11 text-muted op-7 fw-medium">MAILS</span>
          </li>
          @for(mail of mails;track $index){
          <li [class.active]="mail.name === 'All Mails'" class="mail-type">
            <a href="javascript:void(0);">
              <div class="d-flex gap-2 align-items-center">
                <div class="lh-1">

                  <span class="mail-menu-icon" [innerHTML]="getSanitizedSVG(mail.icon)">

                  </span>
                </div>
                <span class="flex-fill text-nowrap">
                  {{ mail.name }}
                </span>

                @if(mail.badge){

                <span class="badge bg-primary">{{ mail.badge }}</span>
                }

              </div>
            </a>
          </li>
          }
          <li class="px-0">
            <span class="fs-11 text-muted op-7 fw-medium">SETTINGS</span>
          </li>
          <li>
            <a href="javascript:void(0);">
              <div class="d-flex gap-2 align-items-center">
                <div class="lh-1">
                  <span class="mail-menu-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
                      <rect width="256" height="256" fill="none" />
                      <path
                        d="M230.1,108.76,198.25,90.62c-.64-1.16-1.31-2.29-2-3.41l-.12-36A104.61,104.61,0,0,0,162,32L130,49.89c-1.34,0-2.69,0-4,0L94,32A104.58,104.58,0,0,0,59.89,51.25l-.16,36c-.7,1.12-1.37,2.26-2,3.41l-31.84,18.1a99.15,99.15,0,0,0,0,38.46l31.85,18.14c.64,1.16,1.31,2.29,2,3.41l.12,36A104.61,104.61,0,0,0,94,224l32-17.87c1.34,0,2.69,0,4,0L162,224a104.58,104.58,0,0,0,34.08-19.25l.16-36c.7-1.12,1.37-2.26,2-3.41l31.84-18.1A99.15,99.15,0,0,0,230.1,108.76ZM128,168a40,40,0,1,1,40-40A40,40,0,0,1,128,168Z"
                        opacity="0.2" />
                      <circle cx="128" cy="128" r="40" fill="none" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="16" />
                      <path
                        d="M130.05,206.11c-1.34,0-2.69,0-4,0L94,224a104.61,104.61,0,0,1-34.11-19.2l-.12-36c-.71-1.12-1.38-2.25-2-3.41L25.9,147.24a99.15,99.15,0,0,1,0-38.46l31.84-18.1c.65-1.15,1.32-2.29,2-3.41l.16-36A104.58,104.58,0,0,1,94,32l32,17.89c1.34,0,2.69,0,4,0L162,32a104.61,104.61,0,0,1,34.11,19.2l.12,36c.71,1.12,1.38,2.25,2,3.41l31.85,18.14a99.15,99.15,0,0,1,0,38.46l-31.84,18.1c-.65,1.15-1.32,2.29-2,3.41l-.16,36A104.58,104.58,0,0,1,162,224Z"
                        fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="16" />
                    </svg>
                  </span>
                </div>
                <span class="flex-fill text-nowrap">
                  Settings
                </span>
              </div>
            </a>
          </li>
          <li class="px-0">
            <span class="fs-11 text-muted op-7 fw-medium">LABELS</span>
          </li>
          @for(label of labels;track $index){
          <li>
            <a href="javascript:void(0);">
              <div class="d-flex align-items-center">
                <span class="me-2 lh-1">
                  <i class="ri-circle-line align-middle fs-10 fw-medium {{ label.iconClass }}"></i>
                </span>
                <span class="flex-fill text-nowrap">{{ label.name }}</span>
              </div>
            </a>
          </li>
          }
          <li>
            <div class="mb-2 fs-12">
              <a href="javascript:void(0)">
                40Gb of 50Gb used
              </a>
            </div>
            <div class="progress progress-xs">
              <div class="progress-bar bg-primary progress-bar-animatedd" role="progressbar" style="width: 58%"
                aria-valuenow="58" aria-valuemin="0" aria-valuemax="100">
              </div>
            </div>
          </li>
        </ul>
      </overlay-scrollbars>

    </div>
  </div>
  <div #totalMailsElement class="total-mails border">
    <div class="total-mails-header d-flex align-items-center border-bottom flex-wrap gap-2">
      <div>
        <input class="form-check-input" type="checkbox" id="checkAll" value="" aria-label="..." [(ngModel)]="allTasksChecked"
        (change)="handleToggleSelectAll($event)">
      </div>
      <div class="flex-fill d-flex align-items-center gap-3 flex-wrap">
        <h6 class="fw-medium mb-0">All Mails</h6>
        <div class="d-flex">
          <div class="btn-list">
            <button class="btn btn-icon btn-sm btn-light" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Reload">
              <i class="ti ti-refresh"></i>
            </button>
            <button class="btn btn-icon btn-sm btn-light" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Archive">
              <i class="ti ti-archive"></i>
            </button>
            <button class="btn btn-icon btn-sm btn-light" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Delete">
              <i class="ti ti-trash"></i>
            </button>
            <button class="btn btn-icon btn-sm btn-light" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Report Spam">
              <i class="ti ti-alert-circle"></i>
            </button>
          </div>
          <spk-dropdowns [Customclass]="'dropdown'" [Icon]="true" [IconClass]="'ti ti-dots-vertical'"
            [class]="'btn btn-icon btn-light btn-sm no-caret'" [Menuclass]="'dropdown-menu dropdown-menu-end'">
            <li><a class="dropdown-item" href="javascript:void(0);">Recent</a></li>
            <li><a class="dropdown-item" href="javascript:void(0);">Unread</a></li>
            <li><a class="dropdown-item" href="javascript:void(0);">Mark All Read</a></li>
            <li><a class="dropdown-item" href="javascript:void(0);">Spam</a></li>
            <li><a class="dropdown-item" href="javascript:void(0);">Delete All</a></li>
          </spk-dropdowns>
        </div>
      </div>
      <div class="d-flex gap-2">
        <div class="input-group">
          <input type="text" class="form-control shadow-none" placeholder="Search Email"
            aria-describedby="button-addon">
          <button class="btn btn-primary" type="button" id="button-addon"><i class="ri-search-line"></i></button>
        </div>
        <button class="btn btn-icon btn-light d-lg-none d-block total-mails-close" (click)="onTotalMailsCloseClick()">
          <i class="ri-close-line"></i>
        </button>
      </div>
    </div>
    <overlay-scrollbars>
    <div class="mail-messages" id="mail-messages">
      <div class="table-responsive mail-messages-container">
        <spk-reusable-tables tableClass="table text-nowrap table-borderless table-hover" [showCheckbox]="false">
          @for(mail of allMailstable;track $index){

          <tr [ngClass]="mail.checked ? 'mail-selected' : ''">
            <td>
              <input class="form-check-input mail-check-input" type="checkbox" id="mail2" value="" [checked]="allTasksChecked"
              [(ngModel)]="mail.checked" [id]="'checkbox' + mail.id">
            </td>
            <td>
              <div class="d-flex align-items-center gap-4">
                <a class="mail-starred" [ngClass]="mail.starred ? 'true' : ''" href="javascript:void(0);"
                  data-bs-toggle="tooltip" data-bs-placement="top" ngbTooltip="Star">
                  <i class="ti ti-star-filled"></i>
                </a>
                <a class="mail-important" [ngClass]="mail.important ? 'true' : ''" href="javascript:void(0);"
                  data-bs-toggle="tooltip" data-bs-placement="top" ngbTooltip="Mark As Important">
                  <i class="ti ti-bookmark"></i>
                </a>
              </div>
            </td>
            <td>
              <div class="d-flex align-items-center gap-2 mail-user-container" data-bs-toggle="offcanvas"
                data-bs-target="#offcanvasRight" aria-controls="offcanvasRight" (click)="openOffcanvas(content1)">
                <div class="lh-1">
                  <span class="avatar avatar-sm avatar-rounded mail-msg-avatar">
                    <img [src]="mail.senderAvatar" [alt]="mail.senderName" />
                  </span>
                </div>
                <div>{{ mail.senderName }}</div>
              </div>
            </td>
            <td>
              <div class="mail-msg" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
                aria-controls="offcanvasRight" (click)="openOffcanvas(content1)">
                <span class="d-block mb-0 fw-medium text-truncate w-75">{{ mail.subject }}
                  @for(tag of mail.badge;track $index){
                  <span class="badge {{tag.className}} ms-2">{{tag.text}}</span>
                  }
                </span>
                <div class="text-muted text-wrap text-truncate mail-msg-content">{{ mail.content }}
                </div>
              </div>
            </td>
            <td><span class="mail-received-time">{{ mail.time }}</span></td>
          </tr>

          }

        </spk-reusable-tables>
      </div>
    </div>
  </overlay-scrollbars>
  </div>
</div>

<!-- Start::mail information offcanvas -->
<ng-template let-offcanvas #content1>
  <div class="offcanvas-body p-0">
    <div class="mails-information">
      <div class="mail-info-header d-flex flex-wrap gap-2 align-items-center">
        <div class="flex-fill d-flex align-items-center gap-1">
          <button class="btn btn-icon btn-light" tabindex="-1" ngbTooltip="Print">
            <i class="ri-printer-line"></i>
          </button>
          <button class="btn btn-icon btn-light ms-1"  tabindex="-1"
            ngbTooltip="Mark as read">
            <i class="ri-mail-open-line"></i>
          </button>
          <button class="btn btn-icon btn-light ms-1"  tabindex="-1"
            ngbTooltip="Reload">
            <i class="ri-refresh-line"></i>
          </button>
        </div>
        <button type="button" class="btn-close btn btn-sm btn-icon border" data-bs-dismiss="offcanvas"
          (click)="offcanvas.close('cross click')" aria-label="Close"></button>
      </div>
      <div class="mail-info-body p-4" id="mail-info-body">
        <div class="d-sm-flex d-block align-items-center justify-content-between mb-4">
          <div>
            <p class="fs-20 fw-medium mb-0">Invoice #45678 â€“ Payment Due Soon</p>
          </div>
          <div class="float-end">
            <span class="fs-13 fw-medium text-muted">Feb 22 2025,03:05PM</span>
          </div>
        </div>
        <div class="d-flex align-items-center gap-2 mb-4">
          <div class="me-1">
            <span class="avatar avatar-md me-2 avatar-rounded mail-msg-avatar">
              <img src="./assets/images/faces/6.jpg" alt="">
            </span>
          </div>
          <div class="flex-fill">
            <h6 class="mb-0 fw-medium">Sarah Smith</h6>
            <span class="text-muted fs-12">to:me</span>
          </div>
          <div class="d-flex align-items-center gap-2 fs-14">
            <a href="javascript:void(0);" class="text-muted" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Starred">
              <i class="ri-star-line"></i>
            </a>
            <a href="javascript:void(0);" class="text-muted ms-1" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Archive">
              <i class="ri-inbox-archive-line"></i>
            </a>
            <a href="javascript:void(0);" class="text-muted ms-1" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Report spam">
              <i class="ri-spam-2-line"></i>
            </a>
            <a href="javascript:void(0);" class="text-muted ms-1" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Delete">
              <i class="ri-delete-bin-line"></i>
            </a>
            <a href="javascript:void(0);" class="text-muted ms-1" data-bs-toggle="tooltip" data-bs-placement="top"
              ngbTooltip="Reply">
              <i class="ri-reply-line"></i>
            </a>
          </div>
        </div>
        <div class="main-mail-content mb-4">
          <p class="text-muted mb-2">Dear Sarah</p>
          <p class="mb-2 text-muted">Thank you for your prompt attention to this matter. As we approach the end of the
            month, please ensure that the payment is made by the 28th to avoid any late fees. You can find the invoice
            attached to this email. If you require any further clarification or need assistance with the payment
            process, don't hesitate to reach out.</p>
          <p class="mb-2 text-muted">Looking forward to your confirmation.</p>
          <p class="mb-0 mt-4">
            <span class="d-block fs-13 text-muted">Best Regards,</span>
            <span class="d-block">Finance Team</span>
          </p>
        </div>
        <div class="mail-attachments mb-4">
          <div class="row">
            <div class="col-xl-3">
              <div class="card custom-card">
                <img src="./assets/images/media/media-43.jpg" class="card-img-top" alt="...">
                <div class="card-body p-2 text-center">
                  <a href="javascript:void(0);" class="text-decoration-underline">Download <i
                      class="ti ti-download"></i></a>
                </div>
              </div>
            </div>
            <div class="col-xl-3">
              <div class="card custom-card">
                <img src="./assets/images/media/media-44.jpg" class="card-img-top" alt="...">
                <div class="card-body p-2 text-center">
                  <a href="javascript:void(0);" class="text-decoration-underline">Download <i
                      class="ti ti-download"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="mail-reply">
          <div id="mail-reply-editor">
            <ngx-editor-menu [editor]="editor1" [toolbar]="toolbar">
            </ngx-editor-menu>
            <ngx-editor [editor]="editor1">
            </ngx-editor>
          </div>
          <div class="mail-info-footer">
            <div class="float-end">
              <button class="btn btn-primary">
                <i class="ri-share-forward-line me-1 d-inline-block align-middle"></i>Forward
              </button>
              <button class="btn btn-danger ms-1">
                <i class="ri-reply-all-line me-1 d-inline-block align-middle"></i>Reply
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<!-- End::mail information offcanvas -->

<!-- Start::compose mail modal -->
<ng-template #content let-modal>
  <div class="modal-header">
    <h6 class="modal-title" id="mail-ComposeLabel">Compose Mail</h6>
    <button type="button" class="btn-close" data-bs-dismiss="modal" (click)="modal.close('cross click')"
      aria-label="Close"></button>
  </div>
  <div class="modal-body px-4">
    <div class="row">
      <div class="col-xl-6 mb-2">
        <label for="fromMail" class="form-label">From<sup><i class="ri-star-s-fill text-success fs-8"></i></sup></label>
        <input type="email" class="form-control" id="fromMail" value="jackmiller2345&#64;gmail.com">
      </div>
      <div class="col-xl-6 mb-2">
        <label for="toMail" class="form-label">To<sup><i class="ri-star-s-fill text-success fs-8"></i></sup></label>
        <spk-ng-select [options]="Mails" [id]="'toMail'" [selectClass]="''" [defaultValue]="selectedTags"
          [clearable]="true" [searchable]="true" [multiple]="true" [hideSelected]="true" placeholder="1 Day"
          [additionalProperties]="{}">
        </spk-ng-select>
      </div>
      <div class="col-xl-6 mb-2">
        <label for="mailCC" class="form-label text-dark fw-medium">Cc</label>
        <input type="email" class="form-control" id="mailCC">
      </div>
      <div class="col-xl-6 mb-2">
        <label for="mailBcc" class="form-label text-dark fw-medium">Bcc</label>
        <input type="email" class="form-control" id="mailBcc">
      </div>
      <div class="col-xl-12 mb-2">
        <label for="Subject" class="form-label">Subject</label>
        <input type="text" class="form-control" id="Subject" placeholder="Subject">
      </div>
      <div class="col-xl-12">
        <label class="col-form-label">Content :</label>
        <div class="mail-compose">
          <div id="mail-compose-editor">
            <ngx-editor-menu [editor]="editor" [toolbar]="toolbar">
            </ngx-editor-menu>
            <ngx-editor [editor]="editor">
            </ngx-editor>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light" (click)="modal.close('cross click')"
      data-bs-dismiss="modal">Cancel</button>
    <button type="button" class="btn btn-primary">Send</button>
  </div>
</ng-template>
<!-- End::compose mail modal -->
